<!DOCTYPE html>
<html>
  <head>
    <title>Emoji Data Formatter üòé</title>
    <style>
      body {
        background-color: #1f1f1f;
        color: #e0e0e0;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 40px;
        display: flex;
        flex-direction: column;
        align-items: left;
        justify-content: center;
      }

      h1 {
        margin-top: 0;
      }

      textarea {
        height: 200px;
        background-color: #2f2f2f;
        color: #e0e0e0;
        border: none;
        padding: 10px;
        resize: none;
        border-radius: 4px;
      }

      .button {
        background-color: #4f4f4f;
        color: #e0e0e0;
        border: none;
        padding: 10px;
        cursor: pointer;
        border-radius: 4px;
        text-decoration: none;
      }

      button {
        background-color: #4f4f4f;
        color: #e0e0e0;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 4px;
      }

      a {
        color: white;
      }

      button:hover {
        background-color: #707070;
      }

      .output-container {
        overflow: hidden;
        margin-top: 20px;
        position: relative;
      }

      #outputData {
        width: 100%;
        height: 200px;
        background-color: #2f2f2f;
        color: #e0e0e0;
        border: none;
        padding: 10px;
        resize: none;
      }

      .copy-button {
        position: absolute;
        right: 14px;
        bottom: 20px;
        border-radius: 4px;
      }

      footer {
        position: absolute;
        bottom: 0;
        text-decoration: none;
        padding: 20px 10px;
      }
    </style>
    <script type="module">
      import { unicodeRawData } from './UnicodeRawData.js';

      document.getElementById('inputData').value = unicodeRawData;

      const formatData = () => {
        const inputData = document.getElementById('inputData').value;

        // Remove comments from the input data
        const cleanedData = inputData.replace(/#.*/g, '');

        // Split the data into lines
        const lines = cleanedData.split('\n');

        // Initialize an empty array to store the formatted objects
        const formattedData = [];

        // Process each line of the data
        for (const line of lines) {
          // Skip empty lines and subgroup lines
          if (line.trim() === '' || line.startsWith('# subgroup:')) {
            continue;
          }

          // Extract the hexcode and description
          const [hexcode, , description] = line.split(';');

          // Extract the valid hexcode
          const validHexcode = hexcode.trim().match(/[0-9A-F ]+/i)[0];

          // Convert hexcode to decimal values
          const decimalValues = validHexcode
            .trim()
            .split(' ')
            .map((code) => parseInt(code, 16));

          // Check if decimal values are valid
          if (decimalValues.some(isNaN)) {
            console.error(`Invalid hexcode: ${hexcode}`);
            continue;
          }

          // Create an object with the extracted information
          const emojiObject = {
            Emoji: String.fromCodePoint(...decimalValues),
            Hexcode: validHexcode,
            Description: description.trim(),
          };

          // Add the object to the formatted data array
          formattedData.push(emojiObject);
        }

        // Convert the formatted data to a JSON string
        const outputData = JSON.stringify(formattedData, null, 2);

        // Update the output box with the formatted data
        document.getElementById('outputData').value = outputData;
      };

      function copyToClipboard() {
        const outputData = document.getElementById('outputData');
        outputData.select();
        document.execCommand('copy');
      }

      document
        .getElementById('formatButton')
        .addEventListener('click', formatData);

      document
        .getElementById('copyButton')
        .addEventListener('click', copyToClipboard);
    </script>
  </head>
  <body>
    <h1>
      <a title="home" class="button" href="./index.html">‚¨ÖÔ∏è</a>
      Data Formatter üòé
    </h1>
    <p>
      Data:
      <a
        href="https://unicode.org/Public/emoji/15.0/emoji-test.txt"
        target="_blank"
      >
        Unicode emoji 15 üòé
      </a>
    </p>
    <textarea id="inputData" placeholder="Enter the data here"></textarea>
    <br />
    <button id="formatButton">Format Data ‚ú®</button>
    <br />
    <div class="output-container">
      <textarea id="outputData" readonly></textarea>
      <button id="copyButton" class="copy-button">Copy to Clipboard üìã</button>
    </div>
    <footer>
      Created by
      <a class="button" target="_blank" href="https://twitter.com/AlexLeybourne"
        >Alex Leybourne üòé</a
      >
    </footer>
  </body>
</html>
